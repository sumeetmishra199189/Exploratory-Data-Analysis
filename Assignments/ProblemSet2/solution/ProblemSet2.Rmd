---
title: "Feeling Thermometer Measurements for 4 Electoral Candidates(Pilot Study 2016)"
author: "Sumeet Mishra"
date: "1/18/2019"
output:
  pdf_document: default
 
---
#Discussed With Team Members:Kimball Wu,Pei-Yi Cheng,Ling Tan

```{r}
library(ggplot2)
anes=read.csv('anes_pilot_2016.csv', header = TRUE)
myvars<-c("fttrump","fthrc","ftsanders","ftrubio","immig_numb")
anes1<-anes[myvars]
#View(anes1)
```

##The library for ggplot is loaded and the input file is loaded to the variable anes. The subset of data that is 'Trump','Clinton','Sanders','Rubio' has been taken for analysis and saved in variable anes1. 

```{r}
anes1$fttrump[ anes1$fttrump > 100 ] = NA
anes1$fthrc[ anes1$fthrc > 100 ] = NA
anes1$ftsanders[ anes1$ftsanders > 100 ] = NA
anes1$ftrubio[ anes1$ftrubio > 100 ] = NA
#View(anes1)
```

##The values of feeling thermometer measurements of the above four candidates is replaced with NA if the value contains more than 100.

```{r}
anes_final=anes1[!(!complete.cases(anes1)), ]
cnames=c('Trump','Clinton','Sanders','Rubio','Immigration')
colnames(anes_final)=c(cnames)
#View(anes_final)
```

##The rows that contains NA for 1 candidate is removed from anes1 and the final values is saved in variable anes_final. The column names were changed to the candidate names for more readability.

```{r message=FALSE}
library(tidyverse)
anes_final.long <- gather(anes_final, key = "Candidates", value = "Score", c(Trump,
Clinton, Sanders, Rubio))
ggplot(anes_final.long,aes(x=Score))+geom_density()+facet_wrap(~Candidates)+xlab('Thermometer feeling Measurements')+ggtitle('Density plot of Thermometer feeling Measurements for 4 Presidential Candidates')
```

##The density plots for the four candidates were ploted according to data present in anes_final.long . X-axis contains the values of feeling thermometer measurements for each candidates. From the graph it is observed that -

##1.Trump:People have cold feeling towards Trump. The density increased a bit towards the end but peak is still between '0-10'.

##2.Clinton:Cold feeling as shown in the graph. Peak is between '0-10'. The density is increased towards the end after a minima and the density is better than Trump towards the end. 

##3.Sanders: For Sanders we observed 3 peaks('0-10','50','90') in the graph which means almost equal number of people gave ratings in the above 3 regions. That means people do not have a general view towards him or unsure about him.

##4.Rubio: Two peaks were observed for Rubio and the peak at '50' is slightly greater than the peak between '0-10'. That means more people gave him a moderately warm rating. 

```{r}
Trump.m = anes_final %>% group_by(Immigration) %>% summarise(Mean = mean(Trump))
Trump.m$candidate='Trump'

Clinton.m = anes_final %>% group_by(Immigration) %>% summarise(Mean = mean(Clinton))
Clinton.m$candidate='Clinton'

Sanders.m = anes_final %>% group_by(Immigration) %>% summarise(Mean = mean(Sanders))
Sanders.m$candidate='Sanders'

Rubio.m = anes_final %>% group_by(Immigration) %>% summarise(Mean = mean(Rubio))
Rubio.m$candidate='Rubio'

gg<-rbind(Trump.m,Clinton.m,Sanders.m,Rubio.m)
gg$Immigration <- ordered(gg$Immigration,levels=c(1,2,3,4,5,6,7),
                          labels=c("Increased a lot",
                                   "Increased a moderate amount",
                                   "Increased a little",
                                   "Kept the same",
                                   "Decreased a little",
                                   "Decreased a moderate amount",
                                   "Decreased a lot")) 

ggplot(gg,aes(x=Mean,y=Immigration))+
  geom_point()+facet_wrap(~candidate)+xlab('Mean Thermometer feeling Measurements')+
  ggtitle('Mean thermometer feeling ~ Immigration Attitude')
  
```

##For the 2nd graph 4 tables were generated by grouping Immigration and Summarising over the mean thermometer feeling of individual candidates. 1 more column was appended to the each table containing Candidates names before binding all the tables and saved into variable gg. The graph was plotted with X-axis as the mean thermometer feeling and Y-axis as Immigration attitude.
##It is observed that-

##1.The mean of thermometer feeling of people is increasing for 'Clinton' and 'Sanders' towards their positive immigration attitude whereas it is increasing for 'Trump' towards his negative immigration attitude. 
##2.For 'Rubio' the mean thermometer feeling is increased a bit against his negative immigration attitude but the mean is still between '40-50'.  




